# 2233recorder - 今日开发TODOList（MVP版本）

## 今日目标

完成2233recorder的MVP版本开发，实现核心功能：
- 基础项目结构搭建
- 配置文件系统
- B站直播间状态监控
- 基础录制功能
- 简单视频处理
- 最小化Web管理界面

## 详细任务列表

### 1. 项目初始化（9:00-10:00）

| 任务ID | 任务名称 | 优先级 | 状态 | 预计时间 | 交付物 |
|--------|----------|--------|------|----------|--------|
| 1.1 | 创建项目目录结构 | 高 | 待开始 | 15分钟 | 完整的目录结构 |
| 1.2 | 初始化Python项目 | 高 | 待开始 | 15分钟 | pyproject.toml或setup.py |
| 1.3 | 安装核心依赖 | 高 | 待开始 | 15分钟 | requirements.txt |
| 1.4 | 创建.gitignore文件 | 中 | 待开始 | 15分钟 | .gitignore |

**任务详情**：
- 1.1 目录结构：
  ```
  2233recorder/
  ├── src/
  │   ├── api/          # 平台API封装
  │   ├── config/       # 配置管理
  │   ├── monitor/      # 监控模块
  │   ├── recorder/     # 录制模块
  │   ├── processor/    # 视频处理模块
  │   ├── web/          # Web管理模块
  │   └── utils/        # 工具函数
  ├── config/           # 配置文件目录
  ├── logs/             # 日志目录
  ├── recordings/       # 录制文件目录
  └── tests/            # 测试代码
  ```

- 1.2 Python项目初始化：使用`python -m venv venv`创建虚拟环境

- 1.3 核心依赖：
  - requests：HTTP请求
  - pyyaml：YAML配置文件解析
  - fastapi：Web框架
  - uvicorn：ASGI服务器
  - ffmpeg-python：FFmpeg封装

### 2. 配置文件系统（10:00-10:45）

| 任务ID | 任务名称 | 优先级 | 状态 | 预计时间 | 交付物 |
|--------|----------|--------|------|----------|--------|
| 2.1 | 创建主配置文件模板 | 高 | 待开始 | 15分钟 | config/config.yaml |
| 2.2 | 创建房间配置文件模板 | 高 | 待开始 | 15分钟 | config/rooms.yaml |
| 2.3 | 实现配置文件读取功能 | 高 | 待开始 | 15分钟 | src/config/config.py |

**任务详情**：
- 2.1 主配置文件模板：包含系统、监控、录制、处理、Web等基础配置
- 2.2 房间配置文件模板：包含至少一个B站直播间的配置
- 2.3 配置读取功能：实现YAML配置文件的加载和解析

### 3. B站API封装（10:45-11:30）

| 任务ID | 任务名称 | 优先级 | 状态 | 预计时间 | 交付物 |
|--------|----------|--------|------|----------|--------|
| 3.1 | 实现B站直播间状态获取 | 高 | 待开始 | 30分钟 | src/api/bilibili_api.py |
| 3.2 | 测试API功能 | 高 | 待开始 | 15分钟 | 测试脚本 |

**任务详情**：
- 3.1 B站API：使用`https://api.live.bilibili.com/room/v1/Room/get_info`获取直播状态
- 3.2 测试脚本：创建简单脚本测试API功能

### 4. 监控核心逻辑（11:30-12:30）

| 任务ID | 任务名称 | 优先级 | 状态 | 预计时间 | 交付物 |
|--------|----------|--------|------|----------|--------|
| 4.1 | 实现直播间状态监控函数 | 高 | 待开始 | 30分钟 | src/monitor/monitor.py |
| 4.2 | 实现录制触发逻辑 | 高 | 待开始 | 30分钟 | src/monitor/trigger.py |

**任务详情**：
- 4.1 监控函数：定时检查直播间状态
- 4.2 触发逻辑：开播自动开始录制，下播自动停止

### 5. 录制核心功能（14:00-15:30）

| 任务ID | 任务名称 | 优先级 | 状态 | 预计时间 | 交付物 |
|--------|----------|--------|------|----------|--------|
| 5.1 | 实现录播姬下载功能 | 高 | 待开始 | 30分钟 | src/recorder/updater.py |
| 5.2 | 实现基础录制功能 | 高 | 待开始 | 60分钟 | src/recorder/core.py |

**任务详情**：
- 5.1 录播姬下载：从GitHub下载最新版BililiveRecorder
- 5.2 录制功能：调用录播姬进行直播录制

### 6. 简单视频处理（15:30-16:30）

| 任务ID | 任务名称 | 优先级 | 状态 | 预计时间 | 交付物 |
|--------|----------|--------|------|----------|--------|
| 6.1 | 实现FLV到MP4格式转换 | 中 | 待开始 | 30分钟 | src/processor/converter.py |
| 6.2 | 实现简单水印添加 | 中 | 待开始 | 30分钟 | src/processor/watermark.py |

**任务详情**：
- 6.1 格式转换：使用FFmpeg将FLV转换为MP4
- 6.2 水印添加：添加简单的文字水印

### 7. 基础Web管理界面（16:30-18:00）

| 任务ID | 任务名称 | 优先级 | 状态 | 预计时间 | 交付物 |
|--------|----------|--------|------|----------|--------|
| 7.1 | 搭建FastAPI基础框架 | 高 | 待开始 | 30分钟 | src/web/app.py |
| 7.2 | 实现基础API接口 | 高 | 待开始 | 30分钟 | src/web/api/ |
| 7.3 | 创建最小化HTML界面 | 中 | 待开始 | 30分钟 | src/web/static/index.html |

**任务详情**：
- 7.1 FastAPI框架：创建基础的Web应用
- 7.2 API接口：实现直播间列表、监控状态、录制控制等基础接口
- 7.3 HTML界面：创建最简单的Web界面，显示监控状态

### 8. 测试和调试（18:00-19:00）

| 任务ID | 任务名称 | 优先级 | 状态 | 预计时间 | 交付物 |
|--------|----------|--------|------|----------|--------|
| 8.1 | 集成测试所有模块 | 高 | 待开始 | 30分钟 | 测试报告 |
| 8.2 | 修复发现的Bug | 高 | 待开始 | 30分钟 | 修复后的代码 |

**任务详情**：
- 8.1 集成测试：测试所有模块协同工作
- 8.2 Bug修复：修复测试中发现的问题

## 任务依赖关系

```
1.1 → 1.2 → 1.3 → 1.4
  ↓
2.1 → 2.2 → 2.3
  ↓
3.1 → 3.2
  ↓
4.1 → 4.2
  ↓
5.1 → 5.2
  ↓
6.1 → 6.2
  ↓
7.1 → 7.2 → 7.3
  ↓
8.1 → 8.2
```

## MVP功能验证清单

完成今日任务后，需验证以下功能：

1. [ ] 项目能正常启动
2. [ ] 能读取配置文件
3. [ ] 能监控B站直播间状态
4. [ ] 直播间开播时自动开始录制
5. [ ] 直播间下播时自动停止录制
6. [ ] 能将FLV转换为MP4
7. [ ] 能添加简单水印
8. [ ] 能通过Web界面查看监控状态
9. [ ] 能通过Web界面控制录制（开始/停止）

## 开发规范

- 代码遵循PEP 8规范
- 所有函数和类都有简单的注释
- 关键操作有日志记录
- 配置文件使用YAML格式
- Web界面使用简单的HTML/CSS/JavaScript
- 测试代码放在tests目录下

## 今日工作总结

| 总任务数 | 已完成 | 进行中 | 待开始 | 完成率 |
|----------|--------|--------|--------|--------|
| 19 | 0 | 0 | 19 | 0% |

**备注**：
- 每个任务完成后，更新状态为「已完成」
- 遇到问题及时记录，必要时调整任务优先级
- 确保核心功能优先完成
- 保持代码简洁，MVP版本无需实现所有高级功能

---

**今日开发结束时间**：19:00
**今日开发时长**：8小时
**预计完成功能点**：MVP核心功能
**下一步计划**：根据测试结果优化代码，添加更多功能